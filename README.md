# Проект 2. Приложение для работы с API-сервисами по размещению вакансий (на примере HeadHunter.ru)

[1. Цель и суть проекта](#title1) / 
[2. Основные модули](#title2) / 
[3. Вспомогательные модули](#title3) / 
[4. Функция взаимодействия с пользователем](#title4) / 
[5. Установка проекта](#title5) / 
[6. Директория проекта "data"](#title6) / 
[7. Описание файла "config.py"](#title7) / 
[8. Описание файла ".env.example"](#title8)


### <a id="title1">1. Цель и суть проекта</a>
Реализовать программу, которая с помощью API будет получать информацию о вакансиях с платформы HeadHunter в России (возможно использовать с другими аналогичными ресурсами по поиску работы), сохранять результат поиска в файл и позволять удобно работать с ними: добавлять, фильтровать, удалять.

- ***Функциональный код разбит на модули***:
  - Модуль для взаимодействия с API;
  - Модуль для взаимодействия с вакансиями;
  - Модуль для взаимодействия с файлами;
  - "Точка входа" - модуль, запустив который можно получить результат всех реализованных в проекте функциональностей;
  - Модуль со вспомогательными функциями.


- ***Документация для сбора вакансий с hh.ru***:
  - Ссылка на API: https://github.com/hhru/api/.


- ***Выходные данные***:
  - Информация о вакансиях, полученная с разных платформ, сохраненная в JSON-файл;
  - Отфильтрованные и отсортированные вакансии, выводимые пользователю через консоль.

  
### <a id="title2">2. Основные модули / функции</a>


### Абстрактные классы:

1. Модуль `abs_base_api.py` содержит код абстрактного класса ***BaseAPI(ABC)*** для работы с API сервисами с вакансиями. Абстрактный класс содержит следующие @abstractmethod:
   - `__init__`;
   - `load_vacancies(keyword: str)`.


2. Модуль `abs_base_file_work.py` содержит код абстрактного класса ***BaseFileWork(ABC)*** для работы с файлом, который содержит экземпляры класса Vacancy. Абстрактный класс содержит следующие @abstractmethod:
   - `__init__(file_with_vacancies: Path)`;
   - `add_vacancy(vacancy: Union["Vacancy", list["Vacancy"]])`;
   - `get_vacancy(user_keywords)`;
   - `delete_vacancy(vacancy_to_delete)`.


### Базовые классы:

1. Модуль `hh_api.py` содержит код для класса ***HeadHunterAPI(BaseAPI)***, который наследуется от абстрактного класса ***BaseAPI(ABC)*** и описывает реализацию взаимодействия с API платформы по поиску вакансий ***hh.ru (HeadHunter)***. В классе описана реализация 2-х методов, которые были заявлены в абстрактном классе:
   - `__init__` - конструктор для инициализации подключения к API сервису.
   - `load_vacancies(keyword)` - метод для получения вакансии с API сервиса по ключевому слову:
     - ***:param keyword:*** - ключевое слово для получения данных о вакансиях;
     - ***:return:*** - файл с полученными вакансиями.


2. Модуль `get_vacancies.py` содержит код для класса ***Vacancy*** - это класс для работы с вакансиями, который:
   - `__init__` - конструктор для создания вакансии. Инициализация экземпляра класса (объекта);
   - `__validate_currency(currency)` - приватный метод валидации валюты зарплаты:
     - ***:param currency:*** - значение валюты, которое поступает из запроса к API сервиса вакансий;
     - ***:return:*** - возвращает строку 'RUB', если валюта отсутствует, так как:
       1) при отсутствии зарплаты на сервисе вакансий мы будем устанавливать 0;
       2) если зарплата установлена в другой валюте, то будем выполнять конвертацию в рубли.
   - `__validate_salary(salary, currency)` - приватный метод проверки значения зарплаты (валидация пустых значений) и выполнение конвертации валюты в RUB:
     - ***:param salary:*** - значения 'from' и 'to' из 'salary', которые поступают из запроса к API сервиса вакансий;
     - ***:param currency:*** - значение валюты, которое поступает из запроса к API сервиса вакансий;
     - ***:return:*** - возвращает дробное число:
       1) ноль, если зарплата не указана на сервисе вакансий;
       2) конвертируемое значение по текущему курсу валют, если зарплата в отличной от RUB валюте;
       3) текущее значение без изменения, если зарплата на сервисе вакансий указана в RUB.
   - Магические методы для различных операций сравнения объектов класса по уровню зарплаты:
     - `__str__` - магический метод возвращает строковое представление вакансии для print();
     - `__repr__` - магический метод возвращает краткую строку для отладки (repr);
     - `__eq__` - магический метод для операции сравнения 'равенство' (self = other);
     - `__lt__` - магический метод для операции сравнения 'меньше' (self < other);
     - `__le__` - магический метод для операции сравнения 'меньше или равно' (self <= other);
     - `__gt__` - магический метод для операции сравнения 'больше' (self > other);
     - `__ge__` - магический метод для операции сравнения 'больше или равно' (self >= other).
   - Static-метод `cast_to_object_list(vacancies_data)` - преобразует список словарей в список объектов Vacancy:
     - ***:param vacancies_data:*** - файл с полученными вакансиями, которые сформировались в запросе API сервиса вакансий;
     - ***:return:*** - возвращает список объектов Vacancy.


3. Модуль `json_file_work.py` содержит код для класса ***JSONSaver*** - это класс для работы с JSON-файлами (работа с вакансиями):
   - `__init__` - конструктор для инициализации пути к JSON-файлу, который хранит данные по вакансиям.
     - ***:param file_with_vacancies*** - путь к JSON-файлу, в котором будут храниться вакансии.
   - `add_vacancy(vacancy: Union["Vacancy", list["Vacancy"]])` - метод для добавления вакансий в JSON-файл:
     - ***:param vacancy*** - экземпляр класса Vacancy (OBJECT) или список объектов Vacancy (LIST OF OBJECTS).
   - `get_vacancy(user_keywords: str = "")` - метод получения вакансий из JSON-файла по заданным пользователе ключевым словам:
     - ***:param user_keywords*** - ключевые слова через запятую для фильтрации вакансий.
     - ***:return:*** - список найденных вакансий по заданным ключевым словам.
   - `delete_vacancy(vacancy_to_delete: "Vacancy")` - метод удаления вакансий из JSON-файла:
     - ***:param vacancy_to_delete*** - экземпляр класса Vacancy (OBJECT), который будем удалять из файла с вакансиями.


### <a id="title3">3. Вспомогательные модули / функции</a>

1. Модуль ***exchange_rates.py*** содержит код для `get_exchange_rates(currency_name)` - это функция для получения текущего курса валюты по отношению к RUB:
   - ***:param currency_name:*** - название валюты, для которой будет выполняться запрос курса по отношению к RUB;
   - ***:return:*** - курс по интересующей валюте (пример для "USD": функция вернет 101.21);
   - для оптимизации количества запросов к API-сервису по повторяющимся валютам используется кэширование: ***EXCHANGE_RATES_CACHE***.


2. Модуль ***vacancy_to_dict.py*** содержит код для функции `vacancy_to_dict(vacancy: Vacancy)` - это функция для преобразования объектов Vacancy в словарь (OBJECTS --> LIST) для дальнейшего сохранения данных в JSON-файл и другие необходимые форматы.


### <a id="title4">4. Взаимодействие пользователя с программой (модуль *main.py*)</a>

Модуль ***main.py*** содержит код для `user_interaction()` - это функция взаимодействия пользователя с программой, которая позволяет ему:
1. Выбрать платформу для поиска вакансий (например, "HeadHunter");
2. Выполнить первоначальный поисковый запрос среди всех вакансий (например, "Разработчик");
3. Отфильтровать вакансии в заданном городе;
4. Получить топ N-вакансий по уровню зарплаты;
5. Выполнить фильтрацию вакансий по ключевым словам в описании/названии вакансии;
6. Выполнить фильтрацию по зарплате (задать диапазон уровня зарплаты);
7. Сбросить фильтры (вернуть полный список вакансий);
8. Завершить работу с программой.


### <a id="title5">5. Установка проекта</a>
1. Клонируйте репозиторий:
```
git clone https://github.com/MaksimLakovich/Coursework-2-app-for-getting-info-about-vacancies.git
```

2. Установите зависимости:
```
poetry install
```


### <a id="title6">6. Директория проекта "data"</a>
Данная директория проекта создана для записи получаемых результатов работы приложения по сбору информации о вакансиях, а так же для хранения различных сопутствующих данных необходимых для работы кода и выполнения тестирования.
1. файл `json_data_with_vacancies.json` - в данном файле сохраняются поступающие входящие данные по вакансиям, после их итоговой обработки (валидация зп, удаление архивных вакансий и т.д.).

    ПРИМЕР JSON-ФАЙЛА:
    ```json
    [
        {
            "id": "93353083",
            "name": "Тестировщик комфорта квартир",
            "area_name": "Воронеж",
            "alternate_url": "https://hh.ru/vacancy/93353083",
            "salary_from": 100000,
            "salary_to": 150100,
            "salary_currency": "USD",
            "published_at": "2024-02-16T14:58:28+0300",
            "archived": false,
            "snippet_responsibility": "Оценивать вид из окна: встречать рассветы на кухне, провожать алые закаты"
        },
        {
            "id": "56465494",
            "name": "Тестировщик",
            "area_name": "Питер",
            "alternate_url": "https://hh.ru/vacancy/93353083",
            "salary_from": 100000,
            "salary_to": 150100,
            "salary_currency": "USD",
            "published_at": "2024-02-16T14:58:28+0300",
            "archived": false,
            "snippet_responsibility": "Оценивать"
        }
    ]
    ```

### <a id="title7">7. Описание файла "config.py"</a>
Для удобства разделения логики и конфигураций, для удобства управления и возможных модификаций использую данный файл конфигурации для хранения путей к файлам и других настроек.
1. Функция `initialize_directories()` - реализована, чтобы создавать необходимые директории и файлы, если они еще не существуют (например, data).
2. Определен путь к директориям куда будут записываться файлы с данными вакансий (`../data/`).
3. Определен путь путь к JSON-файлу с вакансиями, который размещается в проекте в директории (`../data/`):
   - file_with_vacancies = DATA_DIR / ***"json_data_with_vacancies.json"***.


### <a id="title8">8. Описание файла ".env.example"</a>
Для получения курса валют и конвертации в RUB используется сервис `Exchange Rates Data`:
 - Документация API: https://apilayer.com/exchangerates_data-api
 - API_KEY_EXCHANGE_RATES=your_api_key_here
